GJ.add("app/ms_v2/common/list_page.js",["app/ms_v2/common/base_page.js","jquery","app/common/widget/widget.js","js/util/lazyload/jquery.lazyload.1.7.js"],function(b,a){var e=b("app/ms_v2/common/base_page.js");var d=b("jquery");var c=b("app/common/widget/widget.js");GJ.mix(a,e);a.saveFilter=function(f){GJ.use("app/ms/common/list/save_filter.js",function(g){g(f)})};a.viewHistory=function(f){GJ.use("app/ms/common/view_history.js",function(g){g(f)})};a.keywordSearch=function(f){GJ.use("app/ms_v2/widget/keyword_search_box.js",function(g){g(f)})};a.searchFilter=function(f){var g=d(f.$el);var h=g.find(".js-folder");GJ.use("log_tracker",function(){g.find(".seltab").on("click","a",function(){var j=d(this).text();j=d.trim(j);var i="list@text="+encodeURIComponent(j)+"@atype=click";GJ.LogTracker.trackEvent(i)});g.find("dd").on("click","a",function(){if(d(this).hasClass("business-circle-btn")||d(this).hasClass("js-more-company")){return}var i=d(this).parents("dl.selitem, dl.popula-c, dl.moreitem").find("dt:eq(0)").text(),k=d(this).text();if(d(this).find("span.text").length===1){k=d(this).find("span").text()}i=i.replace(/ã€€/g,"").replace(":","");i=d.trim(i);k=d.trim(k);var j="list@class="+encodeURIComponent(i)+"@text="+encodeURIComponent(k)+"@atype=click";GJ.LogTracker.trackEvent(j)})});if(!g.find(".default-hide").size()){h.hide()}h.click(function(i){g.toggleClass("expand");if(g.hasClass("expand")){GJ.setCookie("EXPAND_LIST_FILTER",1)}else{GJ.removeCookie("EXPAND_LIST_FILTER")}i.preventDefault()})};a.radioWidget=function(f){var g=d(f.$el);g.click(function(){var h=d(this);h.addClass("active").siblings().removeClass("active")})};a.rangeFilter=function(h){var p=d(h.$el);var g=p.find(".js-begin");var o=p.find(".js-end");var n=p.find(".js-btn");var f=h.urlTemplate;g.keyup(function(){var s=d(this);var t=s.val();var r=t.replace(/[^0-9]/g,"");if(t!==r){s.val(r)}}).keydown(function(r){if(r.keyCode===13){o.focus()}});o.keyup(function(){var s=d(this);var t=s.val();var r=t.replace(/[^0-9]/g,"");if(t!==r){s.val(r)}}).keydown(function(r){if(r.keyCode===13&&g.val()){o.val(parseInt(o.val(),10)||"");if(o.val()){q()}}});n.click(function(r){q();return r.preventDefault()});function q(){var t=g.val();var r=o.val();if(t||r){if(!t&&g.data("default-value")!==undefined){t=""+g.data("default-value")}if(!r&&o.data("default-value")!==undefined){r=""+o.data("default-value")}}t=parseInt(t,10);r=parseInt(r,10);if(t>r){var s=r;r=t;t=s}if(d.isNumeric(t)&&d.isNumeric(r)){window.location.href=f.replace("{{begin}}",t).replace("{{end}}",r)}}var m=parseInt(h.maxRange,10),j=parseInt(h.minRange,10);if((d.isNumeric(m)||d.isNumeric(j))){var l=null;var i=function(r){var s=parseInt(d(r).val(),10);if((d.isNumeric(m)&&d.isNumeric(s)&&(m>0)&&(m<s))||(d.isNumeric(j)&&(j>-1)&&(s<j))){if(d(r).attr("name")==="b"){d(r).val(j)}else{d(r).val(m)}}};var k=function(s){var r=parseInt(d(s).attr("maxlength"),10);if(d.isNumeric(r)&&(r-0)){var t=d(s).val();if((t.length===r)){i(s)}}if(l){clearTimeout(l)}l=setTimeout(function(){i(s)},5000)};g.bind({blur:function(){i(this)},keyup:function(){k(this)}});o.bind({blur:function(){i(this)},keyup:function(){k(this)}})}};a.letterNav=function(f){var g=d(f.$el);g.on("mouseenter","[data-letter]",function(){var i=d(this);var h=i.data("letter");i.addClass("active").siblings().removeClass("active");g.addClass("active").find("[data-for-letter]").hide().filter("[data-for-letter="+h+"]").show()}).on("click","[data-letter]",function(){return false})};a.popupTipWidget=function(h){var j=d(h.$el);var l=h.cookieName;var g=h.expire;var f=GJ.getCookie(l);var k=h.autoCloseTime;function i(){GJ.setCookie(l,1,g);j.hide()}if(f){j.hide()}else{j.show()}if(h.handler&&d(h.handler).size()){d(h.handler).click(i)}j.find(".js-close").click(i);if(k){setTimeout(i,k)}};a.checkboxLink=function(f){var g=d(f.$el);g.change(function(){window.location.href=f.url})};a.pagination=function(f){GJ.use("log_tracker",function(){f.$el.on("click","a",function(){GJ.LogTracker.trackEvent("/list@pos=bottom_search_fenye@atype=click")})});if(f.hash){var g=d(f.hash);if(g.size()){d(window).scrollTop(g.position().top)}}};a.lazyLoad=function(f){d(f.$el).find(".js-lazy-load").lazyload({threshold:200})};a.gonggao=function(h){var j=d(h.$el);var l=h.cookieName;if(l&&GJ.getCookie(l)){return}var f=h.expire;var g=h.url;var k=c.template(h.template?d(h.template).html():j.html());d.get(g,function(m){if(m){j.html(k(m)).show().find(".js-close").click(i)}},"json");function i(){GJ.setCookie(l,1,f);j.hide()}};a.fixSearchBar=function(f){if(/MSIE 6.0/.test(window.navigator.userAgent)){return false}var k=d(window);var g=d(f.$el);var j=g.offset().top;var i=GJ.getCookie("ganji_uuid")||"";i=parseInt(i.substr(i.length-2,i.length),10);GJ.use("log_tracker",function(){f.$el.find(".search-r").on("click","a",function(){var l="delete_information";if(d(this).hasClass("btn-pub")){l="submit_information"}GJ.LogTracker.trackEvent(l)})});if(i>=10&&i<15){GJ.use("log_tracker",function(){GJ.LogTracker.trackEvent("search/list_top_boxC@atype=show");g.find('[data-widget="app/ms_v2/widget/top_search_box.js"]').on("search",function(){GJ.LogTracker.trackEvent("search/list_top_boxC@atype=click")})})}var h=d("body");k.on("scrollEvent",function(){if(k.scrollTop()>j){g.addClass("search-fixed");h.addClass("header-fixed")}else{g.removeClass("search-fixed");h.removeClass("header-fixed")}});if(k.scrollTop()>j){g.addClass("search-fixed");h.addClass("header-fixed")}};a.last=function(f){e.last(f);e.selfDirectionBind({})}});